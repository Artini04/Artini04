---
import { Image } from "astro:assets"
import ProjectTypeDiv from "./ProjectTypeDiv.astro"
import ProjectType from "./ProjectType.astro"
import ProjectActionDiv from "./ProjectActionDiv.astro"
import ProjectActionLink from "./ProjectActionLink.astro"
import ProjectPinned from "./ProjectPinned.astro"

interface Props {
	title: string
	description: string
	link: string
	github?: string
	type: string[]
	pinned: boolean

	"cover-img": string
	"cover-alt": string
}

const {
	title,
	description,
	link,
	github,
	type,
	pinned,
	"cover-img": coverImg,
	"cover-alt": coverAlt,
} = Astro.props
---

<!--<div class="project" href={link} target="_blank" data-pinned={pinned}>-->
<div class="project" data-pinned={pinned}>
	<div class="project-media">
		{
			!coverImg ?
				<div class="project__img-none">No image provided!</div>
			:	<Image
					class="project__img"
					src={coverImg}
					alt={coverAlt}
					loading="eager"
					width={1024}
					height={768}
				/>
		}
	</div>
	<div class="project-metadata">
		<p class="project__title">{title}</p>
		<p class="project__description">{description}</p>

		<div class="project-metadata-actions">
			<ProjectTypeDiv>
				{type.map((item) => <ProjectType label={item} />)}
			</ProjectTypeDiv>

			<ProjectActionDiv>
				<ProjectActionLink
					link={link}
					label="Visit"
					icon="tabler:external-link"
				/>

				{
					github && (
						<ProjectActionLink
							link={github}
							label="GitHub"
							icon="tabler:brand-github"
						/>
					)
				}
			</ProjectActionDiv>

			{pinned && <ProjectPinned />}
		</div>
	</div>

	<!--<div class="project-description">
		<p class="project__title">{title}</p>
		<p class="project__description">{description}</p>
		<div class="project-description-tags">
			<div class="project-description-types">
				{type.map((element) => <p class="project__type">{element}</p>)}
			</div>
			{
				pinned && (
					<div class="project-description-active">
						<div class="project-description-active__led" />
					</div>
				)
			}
		</div>
	</div>-->
</div>

<style lang="scss">
	@use "@styles/modules/utilities" as utils;

	$project-media-size: 30%;

	.project {
		display: flex;
		flex-flow: row nowrap;

		border: var(--global-border);
		border-radius: var(--global-border-radius);
		outline: 1px solid transparent;
		overflow: clip;

		&[data-pinned="true"] {
			//background: hsl(220, 90%, 5%);
			order: 0;
		}

		@container (width <= 600px) {
			flex-flow: column nowrap;
		}

		&-media {
			flex: 1 1 $project-media-size;
		}

		&-description {
			display: flex;
			flex-flow: column nowrap;
			gap: 0.2em 0;
		}

		// Image
		&__img {
			width: 100%;
			height: 100%;

			max-height: 150px;
			object-fit: cover;
		}

		// Contents
		&__title {
			font-family: "Oxanium";
			font-weight: bolder;
			font-size: 1.2em;
			line-height: 1.2;
		}

		&__description {
			flex: 1 1 auto;
			font-size: 0.8em;
			color: var(--global-app-font-color-dim);
		}

		&__type {
			font-size: 0.6em;
			padding: 0.3em 0.6em 0.1em;
			width: fit-content;

			background-color: hsl(0, 0%, 15%);
			border-radius: 25px;
		}
	}

	.project-metadata {
		flex: 1 1 calc(100% - $project-media-size);
		padding: 0.6em;

		display: flex;
		flex-flow: column nowrap;
		gap: 0.2em 0;
	}

	.project-metadata-actions {
		display: flex;
		gap: 1em;
		flex-flow: row nowrap;
		place-items: center;
		place-content: center;
	}

	.project-description {
		&-types {
			display: flex;
			flex-flow: row wrap;
			gap: 0.2em;

			flex: 1 1 100%;
		}

		&-tags {
			display: flex;
			flex-flow: row nowrap;
			gap: 1em;
		}

		&-active {
			display: flex;
			place-items: center;
			place-content: center;

			&__led {
				aspect-ratio: 1;
				padding: 0.3em;
				background: lightgreen;
				border-radius: 50px;
			}
		}
	}
</style>
